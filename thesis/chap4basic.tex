\chapter{Описание исходного языка}

Описанный в следующих разделах метод базируется на способе описания языка, принятом в современных средствах разработки \cite{xText}. Этот способ основан на сходстве контекстно-свободных грамматик и мета-моделей: нетерминальные символы соответствуют классам, а правые части продукций задают значения атрибутов и ссылок. Эта аналогия позволяет установить соответствие между целевой мета-моделью и грамматикой и сгенерировать соответствующий транслятор.

\section{Деревья и графы абстрактного синтаксиса}

Прямое соответствие между грамматикой и мета-моделью не всегда возможно, поскольку грамматика (рассматриваемая как описание алгебраических типов \cite{?}) задает множество деревьев, а мета-модель --- множество графов. То есть только мета-модели, все ссылки --- агрегирующие могут быть гарантированно сопоставлены некоторой грамматике.

В современных инструментах предпринимаются попытки решить эту проблему, позволяя пользователю указывать, что те или иные конструкции языка являются ключами для поиска объектов. Примером служат имена переменных: транслятор использует их как ключи для поиска в таблице символов. В общем виде такой процесс трансляции состоит из двух этапов: разбор текста (построение дерева) и разрешение ссылок (замыкание циклов в дереве).
При этом удобно выделять отдельную мета-модель для описания древовидного представления. Таким образом, описание языка состоит из следующих элементов:
\begin{enumerate}
\item контекстно-свободная грамматика,
\item мета-модель для древовидного представления,
\item описание соответствия между грамматикой и древовидной мета-моделью,
\item целевая мета-модель (с перекрестными ссылками),
\item описание процедуры разрешения ссылок, преобразующих дерево в экземпляр целевой мета-модели,
\item семантика языка --- способ обработки экземпляра целевой мета-модели, например, интерпретатор или генератор кода.
\end{enumerate}

Обработку шаблонов и аспектов можно добавить сразу после построения дерева или после разрешения ссылок. В первом случае осуществляется композиция деревьев, а во втором --- композиция графов. Оба подхода имеют свои достоинства и недостатки, однако предложенный ниже метод работает для произвольных мета-моделей, и одинаково применим в обоих случаях.

\input{chap4textmodels.tex}

